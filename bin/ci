#!/bin/bash

set -e

run() {
    printf "%s: ..." "$*"
    if "$@" >/dev/null 2>/dev/null; then
        echo " success"
    else
        echo " failure"
        exit 1
    fi
}

run bin/eager_load
run bin/rubocop
run bin/brakeman -A -q --color
run bin/importmap audit
run bin/bundler-audit check --update --quiet
run npm audit
run bin/secrets
run bin/rails test
run bin/rails test:system
