<!DOCTYPE html>
<html lang="<%= I18n.locale %>">
  <head>
    <title><%= meta_title %></title>
    <meta name="description" content="<%= meta_description %>" />
    <% if meta_canonical_url.present? %>
      <link rel="canonical" href="<%= meta_canonical_url %>" />
    <% end %>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta charset="utf-8" />
    <meta property="og:title" content="<%= meta_title %>" />
    <meta property="og:description" content="<%= meta_description %>" />
    <meta property="og:image" content="<%= meta_image_url %>" />
    <meta property="og:site_name" content="<%= t(".title") %>" />
    <% if meta_canonical_url.present? %>
      <meta property="og:url" content="<%= meta_canonical_url %>" />
    <% end %>
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="<%= I18n.locale %>" />
    <% alternate_locale_urls.each do |locale, url| %>
      <% if locale != I18n.locale %>
        <meta property="og:locale:alternate" content="<%= locale %>" />
        <link rel="alternate" href="<%= url %>" hreflang="<%= locale %>" />
      <% end %>
    <% end %>
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="<%= meta_title %>" />
    <meta name="twitter:description" content="<%= meta_description %>" />
    <meta name="twitter:image" content="<%= meta_image_url %>" />
    <%= csp_meta_tag %>
    <%= csrf_meta_tags %>
    <%= javascript_importmap_tags %>
    <%= action_cable_meta_tag %>
    <%= stylesheet_link_tag("tailwind", data: { turbo_track: "reload" }) %>
    <meta name="turbo-refresh-method" content="morph" />
    <meta name="turbo-refresh-scroll" content="preserve" />
    <%= Sentry.get_trace_propagation_meta.html_safe %>
    <script
      type="text/javascript"
      id="hs-script-loader"
      async
      defer
      src="//js-eu1.hs-scripts.com/147616369.js"
    ></script>
  </head>
  <body
    class="min-h-dvh flex flex-col p-8 border-t-4 <%= Current.border_env %>"
    data-hotwire-native="<%= hotwire_native_app? %>"
  >
    <script>
      window.CODE_ENV = "<%= Current.env %>";
      window.RAILS_ENV = "<%= Rails.env %>";
      window.DEFAULT_COUNTRY_CODE = "<%= default_country_code %>";
      window.time_zone = "<%= current_persisted_time_zone %>";
      window.translations = <%= t(".js").to_json.html_safe %>;
      window.platform = "<%= browser.platform %>";
      window.RECAPTCHA_SITE_KEY = "<%= recaptcha_site_key %>";
      window.GOOGLE_MAPS_API_KEY = "<%= google_maps_api_key %>";
      window.SENTRY_DSN = "<%= sentry_dsn %>";
      window.SENTRY_RELEASE = "<%= sentry_release %>";
      window.SENTRY_ENVIRONMENT = "<%= sentry_environment %>";
      window.SENTRY_FEEDBACK = <%= sentry_feedback.to_json.html_safe %>;
    </script>

    <div data-controller="update-time-zone"></div>

    <% if hotwire_native_app? %>
      <div data-controller="bridge--csrf-token"></div>
      <div data-controller="bridge--notification-token"></div>
      <div
        data-controller="bridge--tab-bar"
        data-bridge--tab-bar-tabs-ios-value="<%= ios_tabs.to_json %>"
        data-bridge--tab-bar-tabs-android-value="<%= android_tabs.to_json %>"
      ></div>

      <% if alert.present? %>
        <div
          data-controller="bridge--flash"
          data-bridge--flash-message-value="<%= alert %>"
          data-bridge--flash-type-value="alert"
        ></div>
      <% end %>

      <% if notice.present? %>
        <div
          data-controller="bridge--flash"
          data-bridge--flash-message-value="<%= notice %>"
          data-bridge--flash-type-value="notice"
        ></div>
      <% end %>

      <% unless hotwire_native_modal? %>
        <div data-controller="bridge--refresh"></div>
        <div data-controller="bridge--share"></div>
        <div
          data-controller="bridge--menu"
          data-bridge--menu-menu-ios-value="<%= ios_menu.to_json %>"
          data-bridge--menu-menu-android-value="<%= android_menu.to_json %>"
        ></div>
      <% end %>
    <% end %>

    <% unless hotwire_native_app? %>
      <%= render("layouts/menu") %>

      <% if alert.present? %>
        <div class="p text-red-600"><%= alert %></div>
      <% end %>

      <% if notice.present? %>
        <div class="p text-green-600"><%= notice %></div>
      <% end %>
    <% end %>

    <%= render_breadcrumbs %>

    <%= yield %>

    <button class="link fixed bottom-0 right-0 m-4" data-controller="feedback">
      <%= t(".feedback") %>
    </button>
  </body>
</html>
