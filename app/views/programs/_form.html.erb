<%= form_for(
  show_url,
  html: {
    class: "flex-1 flex flex-col",
    data: {
      controller: "editor",
      action: "turbo:morph@window->editor#reconnect"
    }
  }
) do |f| %>
  <% program_prompt = f.object.program_prompts.last || ProgramPrompt.new %>
  <% generate = program_prompt.generating? ? t(".generating") : t(".generate") %>

  <% if admin? %>
    <div class="p">
      <%= f.label(:user_id, class: "label") %>
      <%= f.select(:user_id, user_options(user_id: f.object.user_id), {}, class: "input") %>
    </div>
  <% end %>

  <div class="p">
    <%= f.label(:name, class: "label") %>
    <div class="flex items-center gap-4">
      <%= f.text_field(
        :name,
        placeholder: t(".name_placeholder"),
        class: "input max-w-none!"
      ) %>

      <%= f.submit(generate, class: "button", name: "program[generate]") %>
    </div>
    <div class="text-red-600" data-editor-target="error"></div>
  </div>

  <div class="p flex-1 flex flex-col">
    <div class="label"><%= t(".input") %></div>
    <div
      class="flex-1 flex flex-col border border-black rounded overflow-hidden"
    >
      <%= f.hidden_field(:input, data: { editor_target: "input" }) %>
      <div
        class="flex-1 flex flex-col min-h-96"
        data-editor-target="editor"
      ></div>
    </div>
  </div>

  <%= render("program_schedules/nested", f: f) %>

  <div class="p">
    <%= f.submit(
      submit,
      class: "button",
      data: {
        controller: "bridge--button",
        bridge__button_title_value: submit
      }
    ) %>
  </div>
<% end %>
